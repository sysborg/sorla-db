(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){const query = require('../query_language/query.js');class collection extends query{constructor(validationSchema){super(validationSchema);this._documents = [];this._indexes = [];}}module.exports =  collection;},{"../query_language/query.js":7}],2:[function(require,module,exports){const collection = require('../collections/collection.js');class database{constructor(name){this._collections = {};this._name = name;this._collectionCount = 0;return new Proxy(this, {get: (target, prop, receiver) => {if(prop in target._collections){return target._collections[prop];}return target[prop];}});}get name(){return this._name;}createCollection(name, validationSchema){if(this._collections.hasOwnProperty(name) || typeof this[name] !== 'undefined'){throw new Error('Collection already exists');}this._collections[name] = new collection(validationSchema);this._collectionCount++;//creates _id as a index unique}countCollections(){return this._collectionCount;}}module.exports = database;},{"../collections/collection.js":1}],3:[function(require,module,exports){const utils = require('../utils');class documents{constructor(object){this._data = object;this._utils = new utils();return new Proxy(this, {get: (target, prop, receiver) => {if(prop.indexOf('.') > -1)return target._utils.getDotData(target._data, prop);if(prop in target._data)return target._data[prop];return target[prop];}});}}module.exports = documents;},{"../utils":9}],4:[function(require,module,exports){},{}],5:[function(require,module,exports){const documents = require('../documents/document.js');const operatorsCheck = require('./operators.js');class manipulation {constructor(validationSchema = null) {this.validationSchema = validationSchema;this._index = {};this._prohibitedCharacters = ['$', '.'];}_generateKey() {return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {var r = Math.random() * 16 | 0,v = c === 'x' ? r : (r & 0x3 | 0x8);return v.toString(16)});}set validationSchema(validationSchema){if(typeof schemaValidation === 'undefined' || schemaValidation === null)return;if(['object', 'function'].indexOf(typeof schemaValidation) == -1){throw new Error('Invalid schema validation');}this._validationSchema = validationSchema;}_validate(data){//under constructionreturn true;}_validateDocumentsType(documents){const count = documents.reduce((acc, doc) => {return typeof doc !== 'object' ? ++acc : acc;}, 0);return count;}_validateKeys(document){const keys = Object.keys(document);const operators = new operatorsCheck();for(let key of keys){const hasProhibitedCharacters = this._prohibitedCharacters.reduce((acc, char) => {return key.indexOf(char) > -1 ? ++acc : acc;}, 0);if(hasProhibitedCharacters > 0 && !operators.isOperator(key))return false;if(typeof document[key] === 'object')return this._validateKeys(document[key]);if(Array.isArray(document[key])){for(let value of document[key]){if(typeof value === 'object')return this._validateKeys(value);}}}return true;}insertOne(document, callback){if(typeof document !== 'object' || Array.isArray(document))throw new Error('Invalid document type');if(!this._validateKeys(document))throw new Error('Invalid document keys');if(typeof document._id === 'undefined'){let _idKey = '';do {_idKey = this._generateKey();} while(this._documents.find(doc => doc._id === document._id));document._id = _idKey;}if(!this._validate(document))throw new Error('Invalid document');this._documents.push(new documents(document));if(typeof callback === 'function')callback();}insertMany(documents, callback) {console.info(this._validateDocumentsType(documents));if(!Array.isArray(documents) || this._validateDocumentsType(documents) > 0)throw new Error('Documents must be an array of objects');for(let document of documents)this.insertOne(document);if(typeof callback === 'function')callback();}//create index//create indexes}module.exports = manipulation;},{"../documents/document.js":3,"./operators.js":6}],6:[function(require,module,exports){class operators {isOperator(operator) {return ['$or', '$and', '$lt', '$lte', '$gt', '$gte', '$eq', '$ne'].indexOf(operator) > -1;}operatorAnd(queries) {//return { $and: queries };}operatorNot(queries) {//return { $not: queries };}get $or() {return (queries, documents) => {if(!Array.isArray(queries))throw new Error('The $or operator must be an array');let result = false;queries.forEach(query => {});return result;};}get $and() {return this.operatorAnd;}get $not() {return this.operatorNot;}lessThan(document, field, value) {return document[field] < value;}lessThanOrEqual(document, field, value) {return document[field] <= value;}greaterThan(document, field, value) {return document[field] > value;}greaterThanOrEqual(document, field, value) {return document[field] >= value;}equal(document, field, value) {return document[field] == value;}notEqual(document, field, value) {return document[field] != value;}get $lt() {return this.lessThan;}get $lte() {return this.lessThanOrEqual;}get $gt() {return this.greaterThan;}get $gte() {return this.greaterThanOrEqual;}get $eq() {return this.equal;}get $ne() {return this.notEqual;}}module.exports = operators;},{}],7:[function(require,module,exports){const manipulation = require('./manipulation.js');const operators = require('./operators.js');class query extends manipulation{constructor(validationSchema){console.log('manipulation', manipulation);super(validationSchema);this._operators = new operators();}count(){return this._documents.length;}_deepFind(query, firstOne = false){const result = [];const find = (object) => {Object.keys(object).forEach(key => {if(key in this._operators){if(this._operators[key](object[key], query[key]))result.push(object);}if(typeof object[key] === 'object'){find(object[key]);} else{if(object[key] === query[key]){result.push(object);if(firstOne)return object;}}});};find(this._documents);return result;}_projection(documents, fields){const isObject = typeof documents === 'object';documents = Array.isArray(documents) ? documents : [documents];for(let field in fields){documents.forEach(doc => {if(fields[field] === 0)delete doc[field];});}return isObject ? documents[0] : documents;}findOne(query, projection = null){const document = Object.keys(query).length === 0 ? this._documents[0]._data : this._deepFind(query, true);return typeof projection === 'object' ? this._projection(document, projection) : document;}find(query, projection = null){}//find//find one and delete//find one and update//find one and replace}module.exports =  query;},{"./manipulation.js":5,"./operators.js":6}],8:[function(require,module,exports){const database = require('./dbs/database.js');class sorla{constructor(){this._dbs = [];this._selectedDb = null;}_findDbIndex(name){return this._dbs.findIndex(db => db.name == name);}dbExists(name){return this._findDbIndex(name) > -1;}_selectDb(pos){if(!this._dbs.hasOwnProperty(pos)){throw new Error('Database does not exists');}this._selectedDb = this._dbs[pos];}createDb(name){if(this.dbExists(name)){return false;}let pos = this._dbs.length;this._dbs.push(new database(name));return pos;}useDb(name){let pos = null;if(!this.dbExists(name)){pos = this.createDb(name);}this._selectDb(pos === null ? this._findDbIndex(name) : pos);}countDb(){return this._dbs.length;}get db(){return this._selectedDb;}}module.exports = sorla;},{"./dbs/database.js":2}],9:[function(require,module,exports){class utils{get uuid(){return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c){let r = Math.random() * 16 | 0,v = c == 'x' ? r : (r & 0x3 | 0x8);return v.toString(16);});}getDotData(data, field){let fields = field.split('.');fields.forEach(field => {if(typeof data[field] !== 'undefined'){data = data[field];}});return data;}}module.exports = utils;},{}]},{},[1,2,3,4,5,6,7,8,9]);